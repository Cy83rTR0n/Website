<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>WhisperGate Malware</title>
<meta name=description content="Something will put here"><meta name=keywords content="blog,gokarna,hugo,Malware"><meta property="og:url" content="https://Cy83rTR0n.github.io/website/posts/whispergate/"><meta property="og:type" content="website"><meta property="og:title" content="WhisperGate Malware"><meta property="og:description" content="Something will put here"><meta property="og:image" content="https://images.unsplash.com/photo-1544890225-2f3faec4cd60?auto=format&amp;fit=crop&amp;q=60&amp;w=500&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxzZWFyY2h8N3x8aGFja2VyfGVufDB8fDB8fHww"><meta property="og:image:secure_url" content="https://images.unsplash.com/photo-1544890225-2f3faec4cd60?auto=format&amp;fit=crop&amp;q=60&amp;w=500&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxzZWFyY2h8N3x8aGFja2VyfGVufDB8fDB8fHww"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="WhisperGate Malware"><meta name=twitter:description content="Something will put here"><meta property="twitter:domain" content="https://Cy83rTR0n.github.io/website/posts/whispergate/"><meta property="twitter:url" content="https://Cy83rTR0n.github.io/website/posts/whispergate/"><meta name=twitter:image content="https://images.unsplash.com/photo-1544890225-2f3faec4cd60?auto=format&amp;fit=crop&amp;q=60&amp;w=500&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxzZWFyY2h8N3x8aGFja2VyfGVufDB8fDB8fHww"><link rel=canonical href=https://Cy83rTR0n.github.io/website/posts/whispergate/><link rel=stylesheet type=text/css href=/website/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/website/css/main.min.css><link id=dark-theme rel=stylesheet href=/website/css/dark.min.css><script src=/website/js/bundle.min.edd985581bf860dfb4507e5885197f1680160c7fe19f23b31e183126d99dd596.js integrity="sha256-7dmFWBv4YN+0UH5YhRl/FoAWDH/hnyOzHhgxJtmd1ZY="></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css integrity=sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js integrity=sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})})</script></head><body><script type=text/javascript>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://Cy83rTR0n.github.io/website><img src='https://images.unsplash.com/photo-1544890225-2f3faec4cd60?auto=format&amp;fit=crop&amp;q=60&amp;w=500&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxzZWFyY2h8N3x8aGFja2VyfGVufDB8fDB8fHww' alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://Cy83rTR0n.github.io/website>Reverse Engineering Blog</a></div><div class=nav-links><div class=nav-link><a href=https://Cy83rTR0n.github.io/website/><span data-feather=home></span> Home</a></div><div class=nav-link><a href=https://Cy83rTR0n.github.io/website/posts/><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://Cy83rTR0n.github.io/website/projects/><span data-feather=code></span> Projects</a></div><div class=nav-link><a href=https://Cy83rTR0n.github.io/website/tags/><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://github.com/Cy83rTR0n><span data-feather=github></span></a></div><div class=nav-link><a href=https://www.reddit.com/user/Cy83rTr0n/><span data-feather=rss></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only></span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span id=hamburger-menu-toggle-screen-reader-target class=sr-only>menu</span>
<a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://Cy83rTR0n.github.io/website/><span data-feather=home></span> Home</a></li><li class=nav-item><a href=https://Cy83rTR0n.github.io/website/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://Cy83rTR0n.github.io/website/projects/><span data-feather=code></span> Projects</a></li><li class=nav-item><a href=https://Cy83rTR0n.github.io/website/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://github.com/Cy83rTR0n><span data-feather=github></span></a></li><li class=nav-item><a href=https://www.reddit.com/user/Cy83rTr0n/><span data-feather=rss></span></a></li><li class="nav-item dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only>theme</span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>WhisperGate Malware</h1><small role=doc-subtitle>Something will put here</small><p class=post-date>November 1, 2022</p><ul class=post-tags><li class=post-tag><a href=https://Cy83rTR0n.github.io/website/tags/malware>Malware</a></li></ul></div><div class=post-content><p><h1 id=understanding-the-working-of-a-wiper-malware>Understanding the working of a Wiper Malware</h1><hr><h2 id=about><strong>About</strong></h2><p>Microsoft published a report describing a malware campaign given the name “<strong>WhisperGate</strong>” that is targeting Ukrainian systems including government agencies and technology organizations. This malware takes destructive actions on the host in order to render the victim inoperable under the guise of a ransomware infection.</p><hr><h2 id=what-is-a-data-wiper-malware>What is a Data Wiper Malware?</h2><p>The term &ldquo;Wiper&rdquo; derives its name from its fundamental purpose, which is to wipe out data and files with malicious intent. Its primary objective is not just to erase data but to inflict significant damage, often leading to the corruption of files and systems. The main aim of wiper malware is straightforward: destruction. Infamous examples of wiper malware include Shamoon, Maya, DarkSeul, and Whispergate, all of which have wreaked havoc by effectively wiping out data and causing widespread disruption.</p><hr><h2 id=how-did-whispergate-get-deployed><strong>How did Whispergate get deployed?</strong></h2><p>An Advanced Persistent Threat (APT) group, known for its stealthy and persistent tactics, has recently come to light due to its involvement in a cybersecurity incident. This APT group had already gained unauthorized access to a targeted network before their activities were detected. Their methods included the theft of credentials, which allowed them to move laterally within the network and escalate their privileges. Notably, they exploited the CVE-2021-32648 vulnerability, highlighting their technical sophistication. This breach exhibited characteristics of a &ldquo;Defus&rdquo; type of attack, demonstrating the group&rsquo;s ability to remain undetected while carrying out their malicious operations.</p><hr><h2 id=general-features>General Features</h2><ul><li>Overwrite the Master Boot Record (MBR) and exhibit a fake ransom note after the system reboot.</li><li>Download stage 3 from a Discord server.</li><li>Stop and disable Windows Defender.</li><li>Encrypt and damage files and finally ping an address and remove the malware itself from the machine</li></ul><hr><h2 id=initial-analysis>Initial Analysis</h2><ul><li>Whispergate Malware comprises of 4 stages<ul><li>Stage 1:<ul><li>SHA256: a196c6b8ffcb97ffb276d04f354696e2391311db3841ae16c8c9f56f36a38e92</li><li>Creation Time: 2022–01–10 10:37:18</li><li>First Submission: 2022–01–16 20:30:19</li><li>File Type: Win32 EXE</li></ul></li><li>Stage 2:<ul><li>SHA256: dcbbae5a1c61dbbbb7dcd6dc5dd1eb1169f5329958d38b58c3fd9384081c9b78</li><li>Creation Time: 2022–01–10 14:39:54</li><li>First Submission: 2022–01–16 20:31:26</li><li>File Type: Win32 EXE</li></ul></li><li>Stage 3:<ul><li>SHA256 : 923eb77b3c9e11d6c56052318c119c1a22d11ab71675e6b95d05eeb73d1accd6</li><li>Tbopbh.jpg (Reversed)</li><li>SHA256 : 9ef7dbd3da51332a78eff19146d21c82957821e464e8133e9594a07d716d892d</li><li>Creation Time: 2022–01–10 14:39:31</li><li>First Submission: 2022–01–16 21:29:58</li><li>File Type: Win32 DLL</li></ul></li><li>Stage 4<ul><li>32 bit PE file created using gcc</li></ul></li></ul></li></ul><hr><h2 id=master-boot-record>Master Boot Record</h2><p>The Master Boot Record (MBR) is a critical component of a computer&rsquo;s startup process, responsible for initializing and managing the booting of the operating system. It consists of a tiny 512-byte data structure that holds essential information. When a computer is powered on or restarted, the BIOS (or UEFI) reads the MBR from the storage device&rsquo;s first sector. The MBR contains information about the disk&rsquo;s partitions, detailing their location, size, and file systems, as well as information about the operating system to be loaded. The MBR&rsquo;s working principle lies in its ability to locate and pass control to the active partition&rsquo;s boot loader, which then loads the operating system. Any corruption or tampering with the MBR can render a computer unable to boot, emphasizing its critical role in the system&rsquo;s startup process.</p><hr><h2 id=stage---1>Stage - 1</h2><ul><li>Corrupt MBR</li><li>Main APIs -> CreateFileW and WriteFile</li><li>Memory Overwriting</li></ul><p><img src=https://hackmd.io/_uploads/BJ3MtPUQ6.png alt=Untitled.png></p><p><img src=https://hackmd.io/_uploads/r1SHcPI7T.png alt="Untitled 1.png"></p><p><img src=https://hackmd.io/_uploads/Sy9EjvLmT.png alt="Untitled 2.png"></p><hr><h2 id=stage---2>Stage - 2</h2><ul><li>Written in C#</li><li>Download jpg for stage 3</li><li>Description written in russian</li></ul><p><img src=https://hackmd.io/_uploads/ByFjivLmT.png alt="Untitled 3.png"></p><p><img src=https://hackmd.io/_uploads/HyapoP876.png alt="Untitled 4.png"></p><p><img src=https://hackmd.io/_uploads/BkIy3DLXp.png alt="Untitled 5.png"></p><p><img src=https://hackmd.io/_uploads/ry1-nPUmp.png alt="Untitled 6.png"></p><hr><h2 id=stage---3>Stage - 3</h2><ul><li>PE file</li><li>Reversed</li><li>Calls the same fucntion</li><li>Windows defender Exclusion list</li><li>AdvancedRun.exe</li></ul><p><img src=https://hackmd.io/_uploads/rk9r2PI7p.png alt="Untitled 7.png"></p><p><img src=https://hackmd.io/_uploads/Hy5PhDLmp.png alt="Untitled 8.png"></p><p><img src=https://hackmd.io/_uploads/Hyw53wI76.png alt="Untitled 9.png"></p><hr><h2 id=stage---4>Stage - 4</h2><ul><li>Similar to 1st stage in terms of loader and linker</li><li>Two important fucntion to look</li><li>Searches for 120 file extensions</li><li>runs command to delete itself</li></ul><p><img src=https://hackmd.io/_uploads/HJHgpD876.png alt="Untitled 10.png"></p><p><img src=https://hackmd.io/_uploads/Sy5b6vLm6.png alt="Untitled 11.png"></p><p><img src=https://hackmd.io/_uploads/BJCzTDIQT.png alt="Untitled 12.png"></p><p><img src=https://hackmd.io/_uploads/B1H46vLXa.png alt="Untitled 13.png"></p><p><img src=https://hackmd.io/_uploads/H1cHav87a.png alt="Deletes itself"></p><hr><h2 id=references>References</h2><ul><li><a href=https://www.netskope.com/blog/netskope-threat-coverage-whispergate>https://www.netskope.com/blog/netskope-threat-coverage-whispergate</a></li><li><a href=https://www.techtarget.com/whatis/definition/Master-Boot-Record-MBR>https://www.techtarget.com/whatis/definition/Master-Boot-Record-MBR</a></li><li><a href=https://docs.microsoft.com/en-in/>https://docs.microsoft.com/en-in/</a></li><li><a href=https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/>https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/</a></li><li><a href=https://www.ntfs.com/guid-part-table.htm>https://www.ntfs.com/guid-part-table.htm</a></li></ul></p></div><div class=prev-next></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="topFunction()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg><script>let mybutton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){smoothScrollToTop()}function smoothScrollToTop(){const e=()=>{const t=document.documentElement.scrollTop||document.body.scrollTop;t>0&&(window.requestAnimationFrame(e),window.scrollTo(0,t-t/8))};e()}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><a href=#understanding-the-working-of-a-wiper-malware>Understanding the working of a Wiper Malware</a><ul><li><a href=#about><strong>About</strong></a></li><li><a href=#what-is-a-data-wiper-malware>What is a Data Wiper Malware?</a></li><li><a href=#how-did-whispergate-get-deployed><strong>How did Whispergate get deployed?</strong></a></li><li><a href=#general-features>General Features</a></li><li><a href=#initial-analysis>Initial Analysis</a></li><li><a href=#master-boot-record>Master Boot Record</a></li><li><a href=#stage---1>Stage - 1</a></li><li><a href=#stage---2>Stage - 2</a></li><li><a href=#stage---3>Stage - 3</a></li><li><a href=#stage---4>Stage - 4</a></li><li><a href=#references>References</a></li></ul></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2023 The Marauders</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/526avijitgupta/gokarna>Gokarna</a></span></footer></body></html>